# StudyBuddy - Neurosurgical Knowledge Base System
# Environment Configuration Template
# Copy this to .env and fill in your values

# ============================================================================
# DATABASE CONFIGURATION (Neurocore Lesson 9: Type-safe config from day 1)
# ============================================================================

# Database Type: sqlite or postgresql
DATABASE_TYPE=sqlite

# SQLite Configuration (for development)
DATABASE_PATH=data/database/studybuddy.db

# PostgreSQL Configuration (for production)
# DATABASE_HOST=localhost
# DATABASE_PORT=5432
# DATABASE_NAME=studybuddy
# DATABASE_USERNAME=studybuddy_user
# DATABASE_PASSWORD=your_secure_password_here

# Connection Pool Settings
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10
DATABASE_ECHO_SQL=false

# ============================================================================
# REDIS CACHE CONFIGURATION (Neurocore Lesson 4: Add caching early)
# ============================================================================

REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
# REDIS_PASSWORD=your_redis_password  # Uncomment if using password

# Cache TTL (Time To Live) in seconds
CACHE_TTL_PUBMED=604800        # 7 days
CACHE_TTL_SEARCH=3600          # 1 hour
CACHE_TTL_EMBEDDINGS=2592000   # 30 days
CACHE_TTL_STATS=300            # 5 minutes

# ============================================================================
# AI PROVIDERS (Neurocore Lesson 2: Security from day 1)
# ============================================================================

# Anthropic (Claude)
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# OpenAI (GPT-4, Embeddings)
OPENAI_API_KEY=your_openai_api_key_here

# Google (Gemini)
# GOOGLE_AI_KEY=your_google_ai_key_here  # Optional

# Default provider for each operation
AI_PROVIDER_CHAPTER_GENERATION=claude
AI_PROVIDER_SEARCH_QUERY=gpt4
AI_PROVIDER_IMAGE_DESCRIPTION=gpt4-vision
AI_PROVIDER_EMBEDDING=openai-ada
AI_PROVIDER_RESEARCH_SUMMARY=claude

# ============================================================================
# PUBMED CONFIGURATION
# ============================================================================

# Required by NCBI
PUBMED_EMAIL=your_email@institution.edu

# Optional: Get higher rate limits (10 req/sec vs 3 req/sec)
# Register at: https://www.ncbi.nlm.nih.gov/account/
# PUBMED_API_KEY=your_pubmed_api_key_here

# ============================================================================
# TIMEOUTS (Neurocore Lesson 7: Timeouts from day 1)
# ============================================================================

# HTTP request timeouts (seconds)
TIMEOUT_HTTP_REQUEST=30
TIMEOUT_AI_COMPLETION=120
TIMEOUT_AI_EMBEDDING=60
TIMEOUT_PUBMED_SEARCH=30

# Database query timeout (seconds)
TIMEOUT_DATABASE_QUERY=30

# Celery task timeouts (seconds)
TIMEOUT_TASK_PDF_INDEX=1800     # 30 minutes
TIMEOUT_TASK_EMBEDDING_GEN=3600 # 1 hour
TIMEOUT_TASK_SEARCH=60          # 1 minute

# ============================================================================
# LOGGING (Neurocore Lesson 5: Structured logging from start)
# ============================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json  # json or text
LOG_FILE=logs/application.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=5

# ============================================================================
# SECURITY
# ============================================================================

# Generate with: python3 -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=your_secret_key_here

# Allowed file paths for PDF indexing (comma-separated)
ALLOWED_LIBRARY_PATHS=/Users/ramihatoum/Downloads/studybuddy/data/books,/tmp

# Maximum file sizes
MAX_PDF_SIZE_MB=500
MAX_IMAGE_SIZE_MB=50

# ============================================================================
# PERFORMANCE (Neurocore Lesson 3: Prevent N+1 queries)
# ============================================================================

# Parallel processing
MAX_WORKERS_CPU=4       # For CPU-bound tasks
MAX_WORKERS_IO=100      # For I/O-bound async tasks

# Batch sizes
BATCH_SIZE_EMBEDDINGS=50
BATCH_SIZE_PUBMED=5
BATCH_SIZE_PDF_PAGES=100

# Search limits
SEARCH_MAX_RESULTS=100
SEARCH_DEFAULT_RESULTS=20

# ============================================================================
# FEATURE FLAGS
# ============================================================================

ENABLE_AI_CHAPTER_DETECTION=true
ENABLE_IMAGE_EXTRACTION=true
ENABLE_PUBMED_RESEARCH=true
ENABLE_CACHE=true
ENABLE_METRICS=false  # Prometheus metrics (optional)

# ============================================================================
# DEVELOPMENT SETTINGS
# ============================================================================

DEBUG=false
TESTING=false

# Set to true to use mocks for AI providers in tests
MOCK_AI_PROVIDERS_IN_TESTS=true

# Set to true to use in-memory cache instead of Redis in tests
USE_MEMORY_CACHE_IN_TESTS=true
